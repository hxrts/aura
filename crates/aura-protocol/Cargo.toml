# Protocol coordination - manages distributed protocols (DKD, Resharing, Locking, Recovery)
[package]
name = "aura-protocol"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
authors.workspace = true
license.workspace = true

[lints]
workspace = true

[features]
default = []

[dependencies]
# Workspace crates
aura-core = { path = "../aura-core" }
aura-effects = { path = "../aura-effects" }
aura-composition = { path = "../aura-composition" }
aura-journal = { path = "../aura-journal" }
# Note: do NOT depend on aura-relational to avoid cycles (Layer 4 -> Layer 5).
# Guardian coordinator will be in Layer 4; relational helpers stay in aura-relational.
aura-wot = { path = "../aura-wot" }
aura-transport = { path = "../aura-transport" }
aura-mpst = { path = "../aura-mpst" }
aura-macros = { path = "../aura-macros" }
aura-store = { path = "../aura-store" }
frost-ed25519 = { workspace = true }
async-lock = "3.0"

# Curve operations
curve25519-dalek = { workspace = true }
ed25519-dalek = { workspace = true }

# Cryptographic hashing (retain for protocol hashing needs)
sha2 = { workspace = true }

# Cryptography provided through aura-core
hmac = { workspace = true }
hkdf = { workspace = true }
aes-gcm = { workspace = true }
getrandom = { workspace = true }
rand_chacha = { workspace = true }

# Serialization
serde = { workspace = true }
serde_json = { workspace = true }
# serde_bytes = { workspace = true } # removed - unused
bincode = { workspace = true }

# Async
tokio = { workspace = true }
futures = { workspace = true }
async-trait = { workspace = true }

# Utilities
uuid = { workspace = true }
thiserror = { workspace = true }
tracing = { workspace = true }
rand = { workspace = true }
subtle = { workspace = true }
zeroize = { workspace = true }
hex = { workspace = true }
base64 = { workspace = true }
once_cell = { workspace = true }
parking_lot = { workspace = true }

# Choreographic programming dependencies
rumpsteak-aura = { workspace = true }
rumpsteak-aura-choreography = { workspace = true }

# Authorization tokens
biscuit-auth = { workspace = true }


[dev-dependencies]
# Testing infrastructure (Layer 4 can use testkit)
aura-testkit = { path = "../aura-testkit" }
criterion = { version = "0.5", features = ["async_tokio", "html_reports"] }

[[bench]]
name = "effect_system"
harness = false

[[bench]]
name = "context_propagation"
harness = false

[[bench]]
name = "handler_performance"
harness = false
