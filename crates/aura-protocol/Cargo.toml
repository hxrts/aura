# Protocol coordination - manages distributed protocols (DKD, Resharing, Locking, Recovery)
[package]
name = "aura-protocol"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
authors.workspace = true
license.workspace = true

[lints]
workspace = true

[features]
default = []
testing = []
fixture_effects = []
consensus_frost_full = []  # Enable full FROST threshold signing in consensus choreography

[dependencies]
# Workspace crates
aura-core = { path = "../aura-core" }
aura-effects = { path = "../aura-effects" }
aura-composition = { path = "../aura-composition" }
aura-journal = { path = "../aura-journal" }
aura-verify = { path = "../aura-verify" }
aura-wot = { path = "../aura-wot" }
aura-transport = { path = "../aura-transport" }
aura-mpst = { path = "../aura-mpst" }
aura-macros = { path = "../aura-macros" }
aura-store = { path = "../aura-store" }
frost-ed25519 = { workspace = true }

# Curve operations
curve25519-dalek = { workspace = true }
ed25519-dalek = { workspace = true }

# Cryptographic hashing (retain for protocol hashing needs)
sha2 = { workspace = true }

# Cryptography provided through aura-core
blake3 = { workspace = true }
hmac = { workspace = true }
hkdf = { workspace = true }
aes-gcm = { workspace = true }
getrandom = { workspace = true }

# Serialization
serde = { workspace = true }
serde_json = { workspace = true }
serde_cbor = { workspace = true }
# serde_bytes = { workspace = true } # removed - unused
bincode = { workspace = true }

# Async
tokio = { workspace = true }
tokio-stream = { workspace = true }
futures = { workspace = true }
async-trait = { workspace = true }

# Utilities
uuid = { workspace = true }
thiserror = { workspace = true }
anyhow = { workspace = true }
tracing = { workspace = true }
rand = { workspace = true }
subtle = { workspace = true }
zeroize = { workspace = true }
hex = { workspace = true }
chrono = { workspace = true }
once_cell = { workspace = true }
dirs = { workspace = true }
parking_lot = { workspace = true }
lru = "0.12"
string_cache = "0.8"

# Choreographic programming dependencies
rumpsteak-aura = { workspace = true }
rumpsteak-aura-choreography = { workspace = true }

# Authorization tokens
biscuit-auth = { workspace = true }


[dev-dependencies]
# Testing infrastructure (Layer 4 can use testkit)
aura-testkit = { path = "../aura-testkit" }
# NOTE: aura-agent removed to eliminate Layer 4 â†’ Layer 6 upward dependency
# Use testkit handlers and composition utilities for testing

# Property testing and benchmarking
proptest = { workspace = true }
criterion = { version = "0.5", features = ["async_tokio", "html_reports"] }

[[bench]]
name = "effect_system"
harness = false

[[bench]]
name = "context_propagation"
harness = false

[[bench]]
name = "handler_performance"
harness = false
