[package]
name = "aura-testkit"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
authors.workspace = true
license.workspace = true

[lints]
workspace = true

[features]
default = []
# Enable full effect system from aura-agent (Layer 6)
# Only enable this feature in crates that are Layer 5+ or integration tests
full-effect-system = ["dep:aura-agent"]
# Enable Lean oracle for differential testing against formally verified models
# Requires Lean toolchain and `just lean-oracle-build` to be run first
lean = []
# Enable CrdtCoordinator tests (forwards to aura-protocol/crdt-sync)
crdt-sync = ["aura-protocol/crdt-sync"]

[dependencies]
# Workspace crates - Layer 8 testkit provides test utilities
# Note: aura-protocol removed (was unused, and would create circular dependency)
aura-core = { path = "../aura-core", features = ["simulation"] }
aura-effects = { path = "../aura-effects", features = ["simulation"] }
aura-mpst = { path = "../aura-mpst" }
aura-journal = { path = "../aura-journal" }
aura-relational = { path = "../aura-relational" }
aura-social = { path = "../aura-social" }
aura-transport = { path = "../aura-transport" }
aura-authorization = { path = "../aura-authorization" }
aura-consensus = { path = "../aura-consensus" }
aura-anti-entropy = { path = "../aura-anti-entropy" }
aura-amp = { path = "../aura-amp" }
aura-protocol = { path = "../aura-protocol" }

# App core for RuntimeBridge trait and types
aura-app = { path = "../aura-app" }

# Optional: Full effect system from Layer 6 (only for higher-layer tests)
aura-agent = { path = "../aura-agent", optional = true }

# Async runtime
async-trait = { workspace = true }
tokio = { workspace = true, features = ["full"] }
futures = { workspace = true }
async-io = "1"
async-lock = "3"
async-channel = "1"

# Cryptography provided through aura-core
ed25519-dalek = { workspace = true }
frost-ed25519 = { workspace = true }
sha2 = { workspace = true }

# Randomness
rand = { workspace = true }
rand_chacha = { workspace = true }

# Logging
tracing = { workspace = true }
tracing-subscriber = { workspace = true }

# Utilities
uuid = { workspace = true }
once_cell = { workspace = true }
serde = { workspace = true }
serde_json = { workspace = true }
thiserror = { workspace = true }
subtle = { workspace = true }
zeroize = { workspace = true }
base64 = { workspace = true }
hex = { workspace = true }

# Property testing
proptest = { workspace = true }

# Authorization system
biscuit-auth = { workspace = true }

# Test serialization for global state tests
serial_test = { workspace = true }

[dev-dependencies]
# For testing the test utilities themselves
# tokio-test = { workspace = true } # removed - unused
criterion = { version = "0.5", features = ["async_tokio", "html_reports"] }
bincode = { workspace = true }
