# Session Epoch Management Scenario

[metadata]
name = "session_epoch_management"
description = "Test session epoch increment and credential invalidation"
version = "1.0.0"
author = "Aura Team"
tags = ["session", "epoch", "credentials", "security"]

[setup]
participants = 4
threshold = 3
seed = 456

[network]
latency_range = [50, 150]
drop_rate = 0.05

[[phases]]
name = "session_establishment"
description = "Establish initial session with epoch 1"
timeout_seconds = 3
actions = [
    { type = "run_choreography", choreography = "session_establishment", participants = ["alice", "bob", "carol", "dave"], threshold = 3 }
]

[[phases]]
name = "presence_distribution"
description = "Distribute initial presence tickets"
timeout_seconds = 2
actions = [
    { type = "run_choreography", choreography = "presence_ticket_distribution", participants = ["alice", "bob", "carol", "dave"] }
]

[[phases]]
name = "epoch_increment"
description = "Increment session epoch and invalidate old tickets"
timeout_seconds = 3
actions = [
    { type = "run_choreography", choreography = "epoch_increment", participants = ["alice", "bob", "carol", "dave"], threshold = 3 }
]

[[phases]]
name = "new_presence_issuance"
description = "Issue new presence tickets for epoch 2"
timeout_seconds = 2
actions = [
    { type = "run_choreography", choreography = "presence_ticket_distribution", participants = ["alice", "bob", "carol", "dave"] },
    { type = "verify_property", property = "epoch_monotonic_increase", expected = true },
    { type = "verify_property", property = "old_tickets_invalidated", expected = true }
]

[[properties]]
name = "epoch_monotonic_increase"
property_type = "safety"

[[properties]]
name = "old_tickets_invalidated"
property_type = "safety"

[[properties]]
name = "new_tickets_valid"
property_type = "safety"

[[properties]]
name = "threshold_maintained"
property_type = "safety"

[[properties]]
name = "epoch_increment_completes"
property_type = "liveness"

[[properties]]
name = "new_session_established"
property_type = "liveness"

